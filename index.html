<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOVEREIGN SENTINEL | ASSET WATCH v1.2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;600&display=swap');

        :root {
            --bg-dark: #0a0a0a;
            --panel-bg: rgba(20, 20, 20, 0.6);
            --border-color: rgba(255, 255, 255, 0.1);
        }

        body {
            background-color: var(--bg-dark);
            color: #e5e5e5;
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
        }

        /* VIBE BACKGROUND */
        .grid-bg {
            position: fixed; inset: 0; z-index: -1;
            background-image: 
                linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 40px 40px;
            mask-image: radial-gradient(circle at center, black 40%, transparent 100%);
        }

        /* GLASS PANELS */
        .sentinel-card {
            background: var(--panel-bg);
            backdrop-filter: blur(12px);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        /* HEADER */
        h1 { font-family: 'JetBrains Mono', monospace; letter-spacing: -1px; }
        .mono { font-family: 'JetBrains Mono', monospace; }
        
        /* LAYOUT */
        .main-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 24px;
            max-width: 1400px;
            margin: 40px auto;
            padding: 0 24px;
        }
        .col-span-12 { grid-column: span 12; }
        .col-span-8 { grid-column: span 8; }
        .col-span-4 { grid-column: span 4; }

        @media (max-width: 1024px) {
            .col-span-8, .col-span-4 { grid-column: span 12; }
        }
    </style>
</head>
<body>

    <div class="grid-bg"></div>

    <nav class="flex justify-between items-center px-8 py-6 max-w-[1400px] mx-auto border-b border-white/10">
        <div class="flex items-center gap-3">
            <div class="w-3 h-3 bg-emerald-500 rounded-full animate-pulse shadow-[0_0_10px_#10b981]"></div>
            <h1 class="text-xl font-bold tracking-tighter uppercase">SOVEREIGN SENTINEL <span class="text-xs text-neutral-500 font-normal ml-2">v1.2</span></h1>
        </div>
        <div class="flex gap-8 items-center">
            <div class="text-right">
                <div class="text-[0.6rem] text-neutral-500 uppercase mono">Portfolio Status</div>
                <div class="text-xs text-emerald-500 mono">ACTIVE INTEGRATION</div>
            </div>
            <div class="text-right border-l border-white/10 pl-8">
                <div class="text-[0.6rem] text-rose-500 uppercase mono">Leakage (Fees)</div>
                <div class="text-xs text-rose-400 mono">£0.00</div>
            </div>
        </div>
    </nav>

    <div class="main-grid">
        
        <div class="sentinel-card col-span-8">
            <div class="flex justify-between items-end mb-6">
                <div>
                    <h2 class="text-sm mono text-neutral-400 mb-1">ASSET PERFORMANCE MAP</h2>
                    <p class="text-xs text-neutral-500">True Position Value & Lifetime P&L.</p>
                </div>
            </div>
            
            <div id="heatmap-chart" style="min-height: 400px;"></div>
        </div>

        <div class="sentinel-card col-span-4 flex flex-col gap-4">
            <h2 class="text-sm mono text-neutral-400 uppercase tracking-widest">Sentinel Alerts</h2>
            
            <div class="flex-1 overflow-y-auto space-y-3" id="alerts-container">
            </div>

            <div class="mt-auto pt-4 border-t border-white/5 space-y-2">
                <div class="flex justify-between text-xs mono">
                    <span class="text-neutral-500">Wealth Index</span>
                    <span class="text-white">£175,653.25</span>
                </div>
                <div class="flex justify-between text-xs mono">
                    <span class="text-neutral-500">Cash Reserve</span>
                    <span class="text-white">£15,059.83</span>
                </div>
                <div class="flex justify-between text-xs mono">
                    <span class="text-neutral-500">Last Sync</span>
                    <span class="text-neutral-400">2026-01-23 17:46 UTC</span>
                </div>
            </div>
        </div>

    </div>

    <script>
        // --- 1. DATA INJECTION ---
        const mapData = [{"x": "EG", "y": 21505.845950112598, "fillColor": "#dc3545", "custom_main": "\u00a321,505.85", "custom_sub": "-\u00a3842.80 (-3.77%)"}, {"x": "CNNE", "y": 18804.1066788257, "fillColor": "#dc3545", "custom_main": "\u00a318,804.11", "custom_sub": "-\u00a3364.83 (-1.90%)"}, {"x": "EOG", "y": 18069.3374349642, "fillColor": "#dc3545", "custom_main": "\u00a318,069.34", "custom_sub": "-\u00a31,064.44 (-5.56%)"}, {"x": "NUE", "y": 17924.39023971, "fillColor": "#28a745", "custom_main": "\u00a317,924.39", "custom_sub": "+\u00a34,353.24 (+32.08%)"}, {"x": "CRM", "y": 17592.96, "fillColor": "#dc3545", "custom_main": "\u00a317,592.96", "custom_sub": "-\u00a31,534.84 (-8.02%)"}, {"x": "NFLX", "y": 16381.8, "fillColor": "#dc3545", "custom_main": "\u00a316,381.80", "custom_sub": "-\u00a31,187.40 (-6.76%)"}, {"x": "QCOM", "y": 14088.599999999999, "fillColor": "#dc3545", "custom_main": "\u00a314,088.60", "custom_sub": "-\u00a31,440.60 (-9.28%)"}, {"x": "CTVA", "y": 12526.5, "fillColor": "#28a745", "custom_main": "\u00a312,526.50", "custom_sub": "+\u00a3409.23 (+3.38%)"}, {"x": "BMY", "y": 10317.0, "fillColor": "#28a745", "custom_main": "\u00a310,317.00", "custom_sub": "+\u00a3708.70 (+7.38%)"}, {"x": "SOLV", "y": 7927.0, "fillColor": "#dc3545", "custom_main": "\u00a37,927.00", "custom_sub": "-\u00a3117.73 (-1.46%)"}, {"x": "RIO", "y": 6731.8286265648, "fillColor": "#28a745", "custom_main": "\u00a36,731.83", "custom_sub": "+\u00a32,046.70 (+43.69%)"}, {"x": "BATS", "y": 4328.0, "fillColor": "#28a745", "custom_main": "\u00a34,328.00", "custom_sub": "+\u00a3125.28 (+2.98%)"}, {"x": "VSNT", "y": 3435.45, "fillColor": "#dc3545", "custom_main": "\u00a33,435.45", "custom_sub": "-\u00a3256.37 (-6.94%)"}, {"x": "LGEN", "y": 2582.0, "fillColor": "#dc3545", "custom_main": "\u00a32,582.00", "custom_sub": "-\u00a316.00 (-0.62%)"}, {"x": "LILMF", "y": 0.3386966253, "fillColor": "#dc3545", "custom_main": "\u00a30.34", "custom_sub": "-\u00a3281.34 (-99.88%)"}];

        // --- 2. APEXCHARTS RENDER ENGINE (v1.2) ---
        // Using User's Specific Formatter
        
        var options = {
            series: [
                {
                    data: mapData
                }
            ],
            legend: { show: false },
            chart: {
                height: 400,
                type: 'treemap',
                toolbar: { show: false },
                fontFamily: 'JetBrains Mono'
            },
            colors: [
                '#28a745', '#dc3545' // Base colors, but we use fillColor from data
            ],
            plotOptions: {
                treemap: {
                    distributed: true,
                    enableShades: false
                }
            },
            dataLabels: {
                enabled: true,
                style: { fontSize: '14px', fontWeight: 'bold' },
                formatter: function(text, op) {
                    let point = op.w.config.series[0].data[op.dataPointIndex];
                    return [text, point.custom_main, point.custom_sub];
                }
            },
            tooltip: {
                theme: 'dark',
                y: {
                    formatter: function(value, op) {
                        let point = op.w.config.series[0].data[op.dataPointIndex];
                        return point.custom_sub;
                    }
                }
            },
            stroke: { show: true, width: 2, colors: ['#141414'] }
        };

        var chart = new ApexCharts(document.querySelector("#heatmap-chart"), options);
        chart.render();

        // --- 3. ALERTS RENDERER ---
        // Re-implementing alerts based on the P&L status
        function renderAlerts() {
             const container = document.getElementById('alerts-container');
             container.innerHTML = '';
             
             // Top 6 by Size
             const topAssets = mapData.slice(0, 6);
             
             topAssets.forEach(m => {
                 const isGain = m.fillColor === '#28a745';
                 const div = document.createElement('div');
                 div.className = 'flex items-center justify-between p-3 rounded bg-white/5 border border-white/5';
                 div.innerHTML = `
                     <div class="flex items-center gap-3">
                         <div class="w-1.5 h-1.5 rounded-full ${isGain ? 'bg-emerald-500' : 'bg-rose-500'}"></div>
                         <span class="text-xs font-bold mono uppercase">${m.x}</span>
                     </div>
                     <span class="mono text-[0.6rem] ${isGain ? 'text-emerald-400' : 'text-rose-400'}">
                         ${m.custom_sub.split(' ')[0]} <!-- Show just the cash P&L value -->
                     </span>
                 `;
                 container.appendChild(div);
             });
        }
        
        renderAlerts();

    </script>
</body>
</html>